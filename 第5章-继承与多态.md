# ç¬¬5ç« ï¼šç»§æ‰¿ä¸å¤šæ€

## ğŸ“š å­¦ä¹ ç›®æ ‡

**S**pecific (å…·ä½“)ï¼š
- æ·±å…¥ç†è§£é¢å‘å¯¹è±¡ç¼–ç¨‹ä¸­çš„ç»§æ‰¿æœºåˆ¶
- æŒæ¡Pythonç±»çš„ç»§æ‰¿è¯­æ³•å’Œsuper()å‡½æ•°ä½¿ç”¨
- ç†è§£å¤šæ€çš„æ¦‚å¿µå’Œå®ç°æ–¹å¼
- å­¦ä¼šæŠ½è±¡ç±»å’Œæ¥å£çš„è®¾è®¡æ¨¡å¼

**M**easurable (å¯è¡¡é‡)ï¼š
- èƒ½å¤Ÿè®¾è®¡å¹¶å®ç°åŒ…å«3å±‚ä»¥ä¸Šç»§æ‰¿å…³ç³»çš„ç±»ä½“ç³»
- æ­£ç¡®å®Œæˆ95%ä»¥ä¸Šçš„ç»§æ‰¿å’Œå¤šæ€ç¼–ç¨‹ç»ƒä¹ 
- ç‹¬ç«‹å®Œæˆä¸€ä¸ªå¤æ‚çš„å¤šå±‚ç»§æ‰¿é¡¹ç›®æ¡ˆä¾‹

**A**chievable (å¯å®ç°)ï¼š
- åŸºäºç¬¬4ç« é¢å‘å¯¹è±¡åŸºç¡€ï¼Œæ·±å…¥å­¦ä¹ é«˜çº§ç‰¹æ€§
- é€šè¿‡åŠ¨ç‰©å›­ã€GUIæ¡†æ¶ç­‰ç»å…¸æ¡ˆä¾‹ç†è§£ç»§æ‰¿

**R**elevant (ç›¸å…³æ€§)ï¼š
- ä¸ºè®¾è®¡æ¨¡å¼å’Œæ¡†æ¶å¼€å‘å¥ å®šç†è®ºåŸºç¡€
- åŸ¹å…»è½¯ä»¶æ¶æ„è®¾è®¡æ€ç»´

**T**ime-bound (æ—¶é™æ€§)ï¼š
- 2å‘¨å†…å®Œæˆå­¦ä¹ ï¼ˆ4è¯¾æ—¶ç†è®º+å®è·µï¼‰

## ğŸ—ºï¸ çŸ¥è¯†å¯¼å›¾

```mermaid
mindmap
  root((ç¬¬5ç« ï¼šç»§æ‰¿ä¸å¤šæ€))
    ç»§æ‰¿åŸºç¡€
      ç»§æ‰¿æ¦‚å¿µ
        is-aå…³ç³»
        ä»£ç å¤ç”¨
        å±‚æ¬¡ç»“æ„
      ç»§æ‰¿è¯­æ³•
        class Child(Parent)
        super()å‡½æ•°
        æ–¹æ³•é‡å†™
      è®¿é—®æ§åˆ¶
        protectedæˆå‘˜
        privateæˆå‘˜ç»§æ‰¿
        publicæ¥å£
    å¤šæ€å®ç°
      æ–¹æ³•é‡å†™
        è™šå‡½æ•°æ¦‚å¿µ
        åŠ¨æ€ç»‘å®š
        è¿è¡Œæ—¶å¤šæ€
      æŠ½è±¡åŸºç±»
        abcæ¨¡å—
        @abstractmethod
        æ¥å£è®¾è®¡
      é¸­å­ç±»å‹
        åè®®æ¦‚å¿µ
        ç±»å‹æ£€æŸ¥
        çµæ´»æ€§è®¾è®¡
    é«˜çº§ç‰¹æ€§
      å¤šé‡ç»§æ‰¿
        MROæ–¹æ³•è§£æ
        è±å½¢ç»§æ‰¿é—®é¢˜
        mixinæ¨¡å¼
      ç‰¹æ®Šæ–¹æ³•
        __new__æ–¹æ³•
        __call__æ–¹æ³•
        è¿ç®—ç¬¦é‡è½½
      è£…é¥°å™¨æ¨¡å¼
        ç±»è£…é¥°å™¨
        æ–¹æ³•è£…é¥°å™¨
        å…ƒç±»åŸºç¡€
    è®¾è®¡æ¨¡å¼
      å·¥å‚æ¨¡å¼
      ç­–ç•¥æ¨¡å¼
      æ¨¡æ¿æ–¹æ³•
      è§‚å¯Ÿè€…æ¨¡å¼
```

## ğŸ’¡ 5.1 ç»§æ‰¿åŸºç¡€æ¦‚å¿µ

### 5.1.1 ä»€ä¹ˆæ˜¯ç»§æ‰¿ï¼Ÿ

ç»§æ‰¿æ˜¯é¢å‘å¯¹è±¡ç¼–ç¨‹çš„æ ¸å¿ƒç‰¹æ€§ä¹‹ä¸€ï¼Œå®ƒå…è®¸æˆ‘ä»¬åŸºäºç°æœ‰çš„ç±»åˆ›å»ºæ–°çš„ç±»ã€‚æ–°ç±»ï¼ˆå­ç±»ï¼‰å¯ä»¥è·å¾—ç°æœ‰ç±»ï¼ˆçˆ¶ç±»ï¼‰çš„æ‰€æœ‰å±æ€§å’Œæ–¹æ³•ï¼ŒåŒæ—¶è¿˜å¯ä»¥æ·»åŠ è‡ªå·±ç‰¹æœ‰çš„å±æ€§å’Œæ–¹æ³•ã€‚

**ç”Ÿæ´»ä¸­çš„ç»§æ‰¿ä¾‹å­**ï¼š
- ğŸ§¬ **ç”Ÿç‰©å­¦ç»§æ‰¿**ï¼šå­©å­ç»§æ‰¿çˆ¶æ¯çš„åŸºå› ç‰¹å¾
- ğŸ° **è´¢äº§ç»§æ‰¿**ï¼šå­å¥³ç»§æ‰¿å®¶æ—çš„è´¢äº§
- ğŸ“š **çŸ¥è¯†ä¼ æ‰¿**ï¼šå­¦ç”Ÿç»§æ‰¿è€å¸ˆçš„çŸ¥è¯†ä½“ç³»

**ç¼–ç¨‹ä¸­çš„ç»§æ‰¿**ï¼š
```python
# çˆ¶ç±»ï¼ˆåŸºç±»ï¼‰
class Animal:
    def __init__(self, name, age):
        self.name = name
        self.age = age
    
    def eat(self):
        print(f"{self.name}æ­£åœ¨åƒä¸œè¥¿")
    
    def sleep(self):
        print(f"{self.name}æ­£åœ¨ç¡è§‰")

# å­ç±»ï¼ˆæ´¾ç”Ÿç±»ï¼‰
class Dog(Animal):  # Dogç»§æ‰¿è‡ªAnimal
    def __init__(self, name, age, breed):
        super().__init__(name, age)  # è°ƒç”¨çˆ¶ç±»æ„é€ å‡½æ•°
        self.breed = breed  # å­ç±»ç‰¹æœ‰å±æ€§
    
    def bark(self):  # å­ç±»ç‰¹æœ‰æ–¹æ³•
        print(f"{self.name}åœ¨æ±ªæ±ªå«")
    
    def eat(self):  # é‡å†™çˆ¶ç±»æ–¹æ³•
        print(f"å°ç‹—{self.name}æ­£åœ¨åƒç‹—ç²®")

# ä½¿ç”¨ç»§æ‰¿
dog = Dog("æ—ºè´¢", 3, "é‡‘æ¯›")
dog.eat()    # è°ƒç”¨é‡å†™çš„æ–¹æ³•
dog.sleep()  # è°ƒç”¨ç»§æ‰¿çš„æ–¹æ³•
dog.bark()   # è°ƒç”¨å­ç±»ç‰¹æœ‰æ–¹æ³•
```

### 5.1.2 ç»§æ‰¿çš„å¥½å¤„

#### 1. **ä»£ç å¤ç”¨**
```python
class Vehicle:
    """äº¤é€šå·¥å…·åŸºç±»"""
    def __init__(self, brand, model, year):
        self.brand = brand
        self.model = model
        self.year = year
        self.speed = 0
        self.is_running = False
    
    def start(self):
        self.is_running = True
        print(f"{self.brand} {self.model} å¯åŠ¨äº†")
    
    def stop(self):
        self.is_running = False
        self.speed = 0
        print(f"{self.brand} {self.model} åœæ­¢äº†")
    
    def accelerate(self, increment):
        if self.is_running:
            self.speed += increment
            print(f"å½“å‰é€Ÿåº¦ï¼š{self.speed}km/h")

class Car(Vehicle):
    """æ±½è½¦ç±»"""
    def __init__(self, brand, model, year, doors):
        super().__init__(brand, model, year)
        self.doors = doors
    
    def honk(self):
        print("å˜€å˜€ï¼")

class Motorcycle(Vehicle):
    """æ‘©æ‰˜è½¦ç±»"""
    def __init__(self, brand, model, year, engine_size):
        super().__init__(brand, model, year)
        self.engine_size = engine_size
    
    def wheelie(self):
        print("æ‘©æ‰˜è½¦åè½®è…¾ç©ºï¼")

# æ‰€æœ‰è½¦è¾†éƒ½å¯ä»¥ä½¿ç”¨Vehicleçš„åŸºæœ¬åŠŸèƒ½
car = Car("ä¸°ç”°", "å¡ç½—æ‹‰", 2023, 4)
motorcycle = Motorcycle("é›…é©¬å“ˆ", "R1", 2023, 1000)

car.start()
car.accelerate(50)
car.honk()

motorcycle.start()
motorcycle.accelerate(80)
motorcycle.wheelie()
```

#### 2. **å±‚æ¬¡ç»“æ„å»ºç«‹**
```python
class Employee:
    """å‘˜å·¥åŸºç±»"""
    def __init__(self, emp_id, name, department):
        self.emp_id = emp_id
        self.name = name
        self.department = department
        self.salary = 0
        self.projects = []
    
    def add_project(self, project):
        self.projects.append(project)
        print(f"{self.name}åŠ å…¥é¡¹ç›®ï¼š{project}")
    
    def get_info(self):
        return f"{self.name} - {self.department}éƒ¨é—¨"

class Developer(Employee):
    """å¼€å‘äººå‘˜ç±»"""
    def __init__(self, emp_id, name, department, programming_languages):
        super().__init__(emp_id, name, department)
        self.programming_languages = programming_languages
        self.salary = 12000
    
    def code(self, language):
        if language in self.programming_languages:
            print(f"{self.name}æ­£åœ¨ç”¨{language}ç¼–ç¨‹")
        else:
            print(f"{self.name}ä¸ç†Ÿæ‚‰{language}")
    
    def debug(self):
        print(f"{self.name}æ­£åœ¨è°ƒè¯•ä»£ç ")

class Manager(Employee):
    """ç®¡ç†äººå‘˜ç±»"""
    def __init__(self, emp_id, name, department, team_size):
        super().__init__(emp_id, name, department)
        self.team_size = team_size
        self.salary = 20000
        self.subordinates = []
    
    def hold_meeting(self):
        print(f"{self.name}å¬å¼€å›¢é˜Ÿä¼šè®®")
    
    def assign_task(self, developer, task):
        print(f"{self.name}ç»™{developer.name}åˆ†é…ä»»åŠ¡ï¼š{task}")

class Intern(Developer):
    """å®ä¹ ç”Ÿç±»"""
    def __init__(self, emp_id, name, department, programming_languages, university):
        super().__init__(emp_id, name, department, programming_languages)
        self.university = university
        self.salary = 3000
    
    def learn(self, technology):
        print(f"å®ä¹ ç”Ÿ{self.name}æ­£åœ¨å­¦ä¹ {technology}")

# åˆ›å»ºä¸åŒç±»å‹çš„å‘˜å·¥
dev = Developer("D001", "å¼ ä¸‰", "æŠ€æœ¯", ["Python", "JavaScript"])
manager = Manager("M001", "æå››", "æŠ€æœ¯", 10)
intern = Intern("I001", "ç‹äº”", "æŠ€æœ¯", ["Python"], "æ¸…åå¤§å­¦")

# æ‰€æœ‰å‘˜å·¥éƒ½æœ‰åŸºæœ¬åŠŸèƒ½
print(dev.get_info())
print(manager.get_info())
print(intern.get_info())

# å„è‡ªçš„ç‰¹æ®ŠåŠŸèƒ½
dev.code("Python")
manager.hold_meeting()
intern.learn("React")
```

### 5.1.3 is-aå…³ç³»

ç»§æ‰¿ä½“ç°çš„æ˜¯"is-a"ï¼ˆæ˜¯ä¸€ä¸ªï¼‰å…³ç³»ï¼Œè¿™æ˜¯åŒºåˆ†ç»§æ‰¿å’Œç»„åˆçš„é‡è¦æ ‡å‡†ã€‚

```python
# æ­£ç¡®çš„ç»§æ‰¿å…³ç³» - is-a
class Shape:
    def area(self):
        pass

class Circle(Shape):  # Circle is a Shape âœ“
    def __init__(self, radius):
        self.radius = radius
    
    def area(self):
        return 3.14159 * self.radius ** 2

class Rectangle(Shape):  # Rectangle is a Shape âœ“
    def __init__(self, width, height):
        self.width = width
        self.height = height
    
    def area(self):
        return self.width * self.height

# é”™è¯¯çš„ç»§æ‰¿å…³ç³»ç¤ºä¾‹
class Engine:
    def start(self):
        print("å¼•æ“å¯åŠ¨")

# é”™è¯¯ï¼Car is not an Engine
# class Car(Engine):  # âŒ é”™è¯¯ï¼šæ±½è½¦ä¸æ˜¯å¼•æ“
#     pass

# æ­£ç¡®çš„åšæ³•ï¼šç»„åˆå…³ç³» - has-a
class Car:
    def __init__(self):
        self.engine = Engine()  # Car has an Engine âœ“
    
    def start(self):
        self.engine.start()
```

## ğŸ”§ 5.2 ç»§æ‰¿è¯­æ³•è¯¦è§£

### 5.2.1 åŸºæœ¬ç»§æ‰¿è¯­æ³•

```python
class Parent:
    """çˆ¶ç±»"""
    def __init__(self, name):
        self.name = name
        self.family_trait = "å–„è‰¯"
    
    def introduce(self):
        print(f"æˆ‘æ˜¯{self.name}ï¼Œæˆ‘å¾ˆ{self.family_trait}")

class Child(Parent):
    """å­ç±»ç»§æ‰¿çˆ¶ç±»"""
    def __init__(self, name, age):
        super().__init__(name)  # è°ƒç”¨çˆ¶ç±»æ„é€ å‡½æ•°
        self.age = age
    
    def introduce(self):
        super().introduce()  # è°ƒç”¨çˆ¶ç±»æ–¹æ³•
        print(f"æˆ‘ä»Šå¹´{self.age}å²")

# æµ‹è¯•ç»§æ‰¿
parent = Parent("ç‹çˆ¶")
child = Child("ç‹å­", 25)

parent.introduce()
print("---")
child.introduce()
```

### 5.2.2 super()å‡½æ•°è¯¦è§£

`super()`å‡½æ•°æ˜¯Pythonä¸­è°ƒç”¨çˆ¶ç±»æ–¹æ³•çš„æ ‡å‡†æ–¹å¼ï¼š

```python
class Animal:
    def __init__(self, name, species):
        self.name = name
        self.species = species
        print(f"Animalæ„é€ å‡½æ•°ï¼šåˆ›å»ºäº†{species} {name}")
    
    def make_sound(self):
        print(f"{self.name}å‘å‡ºäº†å£°éŸ³")
    
    def info(self):
        return f"{self.name}æ˜¯ä¸€åª{self.species}"

class Dog(Animal):
    def __init__(self, name, breed):
        # è°ƒç”¨çˆ¶ç±»æ„é€ å‡½æ•°
        super().__init__(name, "çŠ¬")
        self.breed = breed
        print(f"Dogæ„é€ å‡½æ•°ï¼šè¿™æ˜¯ä¸€åª{breed}")
    
    def make_sound(self):
        # æ‰©å±•çˆ¶ç±»æ–¹æ³•
        super().make_sound()  # å…ˆè°ƒç”¨çˆ¶ç±»æ–¹æ³•
        print("æ±ªæ±ªæ±ªï¼")      # å†æ·»åŠ å­ç±»ç‰¹æœ‰è¡Œä¸º
    
    def info(self):
        # é‡å†™çˆ¶ç±»æ–¹æ³•
        base_info = super().info()
        return f"{base_info}ï¼Œå“ç§æ˜¯{self.breed}"

class Puppy(Dog):
    def __init__(self, name, breed, age_months):
        super().__init__(name, breed)
        self.age_months = age_months
        print(f"Puppyæ„é€ å‡½æ•°ï¼š{age_months}ä¸ªæœˆå¤§")
    
    def make_sound(self):
        print(f"å°ç‹—{self.name}å¥¶å£°å¥¶æ°”åœ°å«ï¼š")
        super().make_sound()  # è°ƒç”¨Dogçš„make_sound
    
    def play(self):
        print(f"{self.age_months}ä¸ªæœˆå¤§çš„{self.name}åœ¨ç©è€")

# æµ‹è¯•å¤šå±‚ç»§æ‰¿ä¸­çš„super()
puppy = Puppy("å°ç™½", "é‡‘æ¯›", 3)
print("---")
puppy.make_sound()
print("---")
print(puppy.info())
print("---")
puppy.play()
```

### 5.2.3 æ–¹æ³•é‡å†™ï¼ˆOverrideï¼‰

å­ç±»å¯ä»¥é‡å†™çˆ¶ç±»çš„æ–¹æ³•æ¥å®ç°ä¸åŒçš„è¡Œä¸ºï¼š

```python
class Shape:
    """å›¾å½¢åŸºç±»"""
    def __init__(self, color):
        self.color = color
    
    def area(self):
        """è®¡ç®—é¢ç§¯ - åœ¨åŸºç±»ä¸­æŠ›å‡ºå¼‚å¸¸ï¼Œå¼ºåˆ¶å­ç±»å®ç°"""
        raise NotImplementedError("å­ç±»å¿…é¡»å®ç°areaæ–¹æ³•")
    
    def perimeter(self):
        """è®¡ç®—å‘¨é•¿ - åœ¨åŸºç±»ä¸­æŠ›å‡ºå¼‚å¸¸ï¼Œå¼ºåˆ¶å­ç±»å®ç°"""
        raise NotImplementedError("å­ç±»å¿…é¡»å®ç°perimeteræ–¹æ³•")
    
    def description(self):
        """å›¾å½¢æè¿° - æä¾›é»˜è®¤å®ç°"""
        return f"è¿™æ˜¯ä¸€ä¸ª{self.color}çš„å›¾å½¢"

class Circle(Shape):
    def __init__(self, color, radius):
        super().__init__(color)
        self.radius = radius
    
    def area(self):
        """é‡å†™areaæ–¹æ³•"""
        import math
        return math.pi * self.radius ** 2
    
    def perimeter(self):
        """é‡å†™perimeteræ–¹æ³•"""
        import math
        return 2 * math.pi * self.radius
    
    def description(self):
        """é‡å†™descriptionæ–¹æ³•"""
        base_desc = super().description()
        return f"{base_desc}ï¼ŒåŠå¾„ä¸º{self.radius}çš„åœ†å½¢"

class Rectangle(Shape):
    def __init__(self, color, width, height):
        super().__init__(color)
        self.width = width
        self.height = height
    
    def area(self):
        """é‡å†™areaæ–¹æ³•"""
        return self.width * self.height
    
    def perimeter(self):
        """é‡å†™perimeteræ–¹æ³•"""
        return 2 * (self.width + self.height)
    
    def description(self):
        """é‡å†™descriptionæ–¹æ³•"""
        base_desc = super().description()
        return f"{base_desc}ï¼Œ{self.width}x{self.height}çš„çŸ©å½¢"

class Square(Rectangle):
    def __init__(self, color, side):
        super().__init__(color, side, side)
        self.side = side
    
    def description(self):
        """å†æ¬¡é‡å†™descriptionæ–¹æ³•"""
        return f"è¿™æ˜¯ä¸€ä¸ª{self.color}çš„æ­£æ–¹å½¢ï¼Œè¾¹é•¿ä¸º{self.side}"

# æµ‹è¯•æ–¹æ³•é‡å†™
shapes = [
    Circle("çº¢è‰²", 5),
    Rectangle("è“è‰²", 4, 6),
    Square("ç»¿è‰²", 3)
]

for shape in shapes:
    print(shape.description())
    print(f"é¢ç§¯ï¼š{shape.area():.2f}")
    print(f"å‘¨é•¿ï¼š{shape.perimeter():.2f}")
    print("---")
```

### 5.2.4 å±æ€§ç»§æ‰¿å’Œè®¿é—®æ§åˆ¶

```python
class BankAccount:
    """é“¶è¡Œè´¦æˆ·åŸºç±»"""
    
    def __init__(self, account_number, holder_name, initial_balance):
        self.account_number = account_number     # å…¬å…±å±æ€§
        self.holder_name = holder_name          # å…¬å…±å±æ€§
        self._balance = initial_balance         # ä¿æŠ¤å±æ€§
        self.__pin = "1234"                     # ç§æœ‰å±æ€§
        self._transaction_history = []          # ä¿æŠ¤å±æ€§
    
    def deposit(self, amount):
        """å­˜æ¬¾ - å…¬å…±æ–¹æ³•"""
        if amount > 0:
            self._balance += amount
            self._add_transaction(f"å­˜æ¬¾ +{amount}")
            print(f"å­˜æ¬¾æˆåŠŸï¼Œä½™é¢ï¼š{self._balance}")
    
    def _add_transaction(self, description):
        """æ·»åŠ äº¤æ˜“è®°å½• - ä¿æŠ¤æ–¹æ³•"""
        from datetime import datetime
        self._transaction_history.append({
            'time': datetime.now(),
            'description': description
        })
    
    def __validate_pin(self, pin):
        """éªŒè¯PINç  - ç§æœ‰æ–¹æ³•"""
        return pin == self.__pin
    
    def get_balance(self):
        """è·å–ä½™é¢ - å…¬å…±æ–¹æ³•"""
        return self._balance
    
    def get_transaction_history(self):
        """è·å–äº¤æ˜“å†å² - å…¬å…±æ–¹æ³•"""
        return self._transaction_history.copy()

class SavingsAccount(BankAccount):
    """å‚¨è“„è´¦æˆ·"""
    
    def __init__(self, account_number, holder_name, initial_balance, interest_rate):
        super().__init__(account_number, holder_name, initial_balance)
        self.interest_rate = interest_rate
    
    def add_interest(self):
        """æ·»åŠ åˆ©æ¯"""
        interest = self._balance * self.interest_rate  # å¯ä»¥è®¿é—®ä¿æŠ¤å±æ€§
        self._balance += interest
        self._add_transaction(f"åˆ©æ¯ +{interest:.2f}")  # å¯ä»¥è°ƒç”¨ä¿æŠ¤æ–¹æ³•
        print(f"åˆ©æ¯å·²æ·»åŠ ï¼š{interest:.2f}ï¼Œä½™é¢ï¼š{self._balance}")
    
    def withdraw(self, amount):
        """å–æ¬¾ - å‚¨è“„è´¦æˆ·æœ‰é™åˆ¶"""
        if amount <= self._balance:
            self._balance -= amount
            self._add_transaction(f"å–æ¬¾ -{amount}")
            print(f"å–æ¬¾æˆåŠŸï¼Œä½™é¢ï¼š{self._balance}")
        else:
            print("ä½™é¢ä¸è¶³")

class CheckingAccount(BankAccount):
    """æ”¯ç¥¨è´¦æˆ·"""
    
    def __init__(self, account_number, holder_name, initial_balance, overdraft_limit):
        super().__init__(account_number, holder_name, initial_balance)
        self.overdraft_limit = overdraft_limit
    
    def withdraw(self, amount):
        """å–æ¬¾ - æ”¯ç¥¨è´¦æˆ·å…è®¸é€æ”¯"""
        if amount <= self._balance + self.overdraft_limit:
            self._balance -= amount
            self._add_transaction(f"å–æ¬¾ -{amount}")
            print(f"å–æ¬¾æˆåŠŸï¼Œä½™é¢ï¼š{self._balance}")
        else:
            print(f"è¶…å‡ºé€æ”¯é™é¢")
    
    def get_available_balance(self):
        """è·å–å¯ç”¨ä½™é¢"""
        return self._balance + self.overdraft_limit

# æµ‹è¯•å±æ€§ç»§æ‰¿å’Œè®¿é—®æ§åˆ¶
savings = SavingsAccount("S001", "å¼ ä¸‰", 10000, 0.03)
checking = CheckingAccount("C001", "æå››", 5000, 2000)

# æµ‹è¯•å…¬å…±æ–¹æ³•å’Œä¿æŠ¤å±æ€§çš„è®¿é—®
savings.deposit(1000)
savings.add_interest()

checking.deposit(500)
checking.withdraw(6000)  # ä½¿ç”¨é€æ”¯
print(f"å¯ç”¨ä½™é¢ï¼š{checking.get_available_balance()}")

# ç§æœ‰å±æ€§æ— æ³•ç›´æ¥è®¿é—®
# print(savings.__pin)  # ä¼šæŠ¥é”™
```

ç»§ç»­ç¼–å†™ç¬¬5ç« çš„å…¶ä»–å†…å®¹... 

## ğŸ­ 5.3 å¤šæ€æœºåˆ¶

### 5.3.1 å¤šæ€çš„æ¦‚å¿µ

å¤šæ€ï¼ˆPolymorphismï¼‰æ˜¯é¢å‘å¯¹è±¡ç¼–ç¨‹çš„é‡è¦ç‰¹æ€§ï¼Œæ„æ€æ˜¯"ä¸€ä¸ªæ¥å£ï¼Œå¤šç§å®ç°"ã€‚åŒä¸€ä¸ªæ–¹æ³•è°ƒç”¨å¯ä»¥æ ¹æ®å¯¹è±¡çš„ä¸åŒè€Œè¡¨ç°å‡ºä¸åŒçš„è¡Œä¸ºã€‚

**ç”Ÿæ´»ä¸­çš„å¤šæ€ä¾‹å­**ï¼š
- ğŸµ **ä¹å™¨æ¼”å¥**ï¼šä¸åŒä¹å™¨éƒ½èƒ½"æ’­æ”¾éŸ³ä¹"ï¼Œä½†å£°éŸ³ä¸åŒ
- ğŸš— **äº¤é€šå·¥å…·**ï¼šæ±½è½¦ã€è‡ªè¡Œè½¦ã€é£æœºéƒ½èƒ½"ç§»åŠ¨"ï¼Œä½†æ–¹å¼ä¸åŒ
- ğŸ¾ **åŠ¨ç‰©å«å£°**ï¼šçŒ«å’ª"å–µå–µ"ã€ç‹—ç‹—"æ±ªæ±ª"ã€é¸Ÿå„¿"å•¾å•¾"

```python
class Animal:
    """åŠ¨ç‰©åŸºç±»"""
    def __init__(self, name):
        self.name = name
    
    def make_sound(self):
        """å‘å‡ºå£°éŸ³ - åŸºç±»æä¾›é»˜è®¤å®ç°"""
        print(f"{self.name}å‘å‡ºäº†å£°éŸ³")
    
    def move(self):
        """ç§»åŠ¨æ–¹å¼ - åŸºç±»æä¾›é»˜è®¤å®ç°"""
        print(f"{self.name}åœ¨ç§»åŠ¨")

class Dog(Animal):
    def make_sound(self):
        print(f"ç‹—ç‹—{self.name}ï¼šæ±ªæ±ªæ±ªï¼")
    
    def move(self):
        print(f"ç‹—ç‹—{self.name}åœ¨å¥”è·‘")

class Cat(Animal):
    def make_sound(self):
        print(f"çŒ«å’ª{self.name}ï¼šå–µå–µå–µï½")
    
    def move(self):
        print(f"çŒ«å’ª{self.name}åœ¨ä¼˜é›…åœ°èµ°æ­¥")

class Bird(Animal):
    def make_sound(self):
        print(f"é¸Ÿå„¿{self.name}ï¼šå•¾å•¾å•¾â™ª")
    
    def move(self):
        print(f"é¸Ÿå„¿{self.name}åœ¨å¤©ç©ºä¸­é£ç¿”")

class Fish(Animal):
    def make_sound(self):
        print(f"é±¼å„¿{self.name}ï¼š...ï¼ˆé±¼ä¸ä¼šå«ï¼‰")
    
    def move(self):
        print(f"é±¼å„¿{self.name}åœ¨æ°´ä¸­æ¸¸æ³³")

# å¤šæ€çš„å¨åŠ›ï¼šåŒä¸€ä¸ªå‡½æ•°å¤„ç†ä¸åŒç±»å‹çš„å¯¹è±¡
def animal_concert(animals):
    """åŠ¨ç‰©éŸ³ä¹ä¼š - å±•ç¤ºå¤šæ€"""
    print("ğŸµ åŠ¨ç‰©éŸ³ä¹ä¼šå¼€å§‹äº†ï¼ğŸµ")
    for animal in animals:
        animal.make_sound()  # åŒä¸€ä¸ªæ–¹æ³•è°ƒç”¨ï¼Œä¸åŒçš„è¡Œä¸º
    
    print("\nğŸƒâ€â™€ï¸ åŠ¨ç‰©è¿åŠ¨ä¼šå¼€å§‹äº†ï¼ğŸƒâ€â™€ï¸")
    for animal in animals:
        animal.move()       # åŒä¸€ä¸ªæ–¹æ³•è°ƒç”¨ï¼Œä¸åŒçš„è¡Œä¸º

# åˆ›å»ºä¸åŒç±»å‹çš„åŠ¨ç‰©
zoo_animals = [
    Dog("æ—ºè´¢"),
    Cat("å’ªå’ª"),
    Bird("å°é¸Ÿ"),
    Fish("é‡‘é±¼")
]

# å¤šæ€ï¼šåŒä¸€ä¸ªå‡½æ•°ï¼Œå¤„ç†ä¸åŒç±»å‹çš„å¯¹è±¡
animal_concert(zoo_animals)
```

### 5.3.2 æ–¹æ³•é‡å†™ä¸åŠ¨æ€ç»‘å®š

Pythonä½¿ç”¨åŠ¨æ€ç»‘å®šå®ç°å¤šæ€ï¼Œå³åœ¨è¿è¡Œæ—¶å†³å®šè°ƒç”¨å“ªä¸ªç±»çš„æ–¹æ³•ï¼š

```python
class MediaPlayer:
    """åª’ä½“æ’­æ”¾å™¨åŸºç±»"""
    def __init__(self, filename):
        self.filename = filename
        self.is_playing = False
    
    def play(self):
        """æ’­æ”¾åª’ä½“"""
        self.is_playing = True
        print(f"æ­£åœ¨æ’­æ”¾ï¼š{self.filename}")
    
    def stop(self):
        """åœæ­¢æ’­æ”¾"""
        self.is_playing = False
        print(f"åœæ­¢æ’­æ”¾ï¼š{self.filename}")
    
    def get_info(self):
        """è·å–åª’ä½“ä¿¡æ¯"""
        return f"åª’ä½“æ–‡ä»¶ï¼š{self.filename}"

class AudioPlayer(MediaPlayer):
    """éŸ³é¢‘æ’­æ”¾å™¨"""
    def __init__(self, filename, bitrate):
        super().__init__(filename)
        self.bitrate = bitrate
    
    def play(self):
        """é‡å†™æ’­æ”¾æ–¹æ³•"""
        print(f"ğŸµ å¼€å§‹æ’­æ”¾éŸ³é¢‘ï¼š{self.filename}")
        print(f"   éŸ³è´¨ï¼š{self.bitrate}kbps")
        self.is_playing = True
    
    def get_info(self):
        """é‡å†™ä¿¡æ¯è·å–æ–¹æ³•"""
        base_info = super().get_info()
        return f"{base_info}ï¼ŒéŸ³è´¨ï¼š{self.bitrate}kbps"
    
    def adjust_volume(self, level):
        """éŸ³é¢‘ç‰¹æœ‰æ–¹æ³•"""
        print(f"è°ƒæ•´éŸ³é‡åˆ°ï¼š{level}%")

class VideoPlayer(MediaPlayer):
    """è§†é¢‘æ’­æ”¾å™¨"""
    def __init__(self, filename, resolution):
        super().__init__(filename)
        self.resolution = resolution
    
    def play(self):
        """é‡å†™æ’­æ”¾æ–¹æ³•"""
        print(f"ğŸ¬ å¼€å§‹æ’­æ”¾è§†é¢‘ï¼š{self.filename}")
        print(f"   åˆ†è¾¨ç‡ï¼š{self.resolution}")
        self.is_playing = True
    
    def get_info(self):
        """é‡å†™ä¿¡æ¯è·å–æ–¹æ³•"""
        base_info = super().get_info()
        return f"{base_info}ï¼Œåˆ†è¾¨ç‡ï¼š{self.resolution}"
    
    def toggle_fullscreen(self):
        """è§†é¢‘ç‰¹æœ‰æ–¹æ³•"""
        print("åˆ‡æ¢å…¨å±æ¨¡å¼")

class ImageViewer(MediaPlayer):
    """å›¾ç‰‡æŸ¥çœ‹å™¨"""
    def __init__(self, filename, dimensions):
        super().__init__(filename)
        self.dimensions = dimensions
    
    def play(self):
        """é‡å†™æ’­æ”¾æ–¹æ³•"""
        print(f"ğŸ–¼ï¸ æ˜¾ç¤ºå›¾ç‰‡ï¼š{self.filename}")
        print(f"   å°ºå¯¸ï¼š{self.dimensions}")
        self.is_playing = True
    
    def get_info(self):
        """é‡å†™ä¿¡æ¯è·å–æ–¹æ³•"""
        base_info = super().get_info()
        return f"{base_info}ï¼Œå°ºå¯¸ï¼š{self.dimensions}"
    
    def zoom(self, factor):
        """å›¾ç‰‡ç‰¹æœ‰æ–¹æ³•"""
        print(f"ç¼©æ”¾å›¾ç‰‡ï¼š{factor}å€")

# å¤šæ€åº”ç”¨ï¼šåª’ä½“æ’­æ”¾ç³»ç»Ÿ
class PlaylistManager:
    """æ’­æ”¾åˆ—è¡¨ç®¡ç†å™¨"""
    def __init__(self):
        self.playlist = []
    
    def add_media(self, media):
        """æ·»åŠ åª’ä½“æ–‡ä»¶"""
        self.playlist.append(media)
        print(f"æ·»åŠ åˆ°æ’­æ”¾åˆ—è¡¨ï¼š{media.filename}")
    
    def play_all(self):
        """æ’­æ”¾æ‰€æœ‰åª’ä½“ - å±•ç¤ºå¤šæ€"""
        print("\nğŸª å¼€å§‹æ’­æ”¾æ’­æ”¾åˆ—è¡¨...")
        for media in self.playlist:
            print(f"\nğŸ“„ {media.get_info()}")
            media.play()  # å¤šæ€ï¼šä¸åŒç±»å‹çš„åª’ä½“æœ‰ä¸åŒçš„æ’­æ”¾æ–¹å¼
            print("---")
    
    def get_playlist_info(self):
        """è·å–æ’­æ”¾åˆ—è¡¨ä¿¡æ¯"""
        print("\nğŸ“‹ æ’­æ”¾åˆ—è¡¨ä¿¡æ¯ï¼š")
        for i, media in enumerate(self.playlist, 1):
            print(f"{i}. {media.get_info()}")

# åˆ›å»ºä¸åŒç±»å‹çš„åª’ä½“æ’­æ”¾å™¨
playlist = PlaylistManager()
playlist.add_media(AudioPlayer("ç»å…¸è€æ­Œ.mp3", 320))
playlist.add_media(VideoPlayer("æç¬‘è§†é¢‘.mp4", "1080p"))
playlist.add_media(ImageViewer("ç¾ä¸½é£æ™¯.jpg", "1920x1080"))

# å¤šæ€ï¼šåŒä¸€ä¸ªæ–¹æ³•è°ƒç”¨ï¼Œä¸åŒçš„è¡Œä¸º
playlist.get_playlist_info()
playlist.play_all()
```

### 5.3.3 æŠ½è±¡åŸºç±»ï¼ˆABCï¼‰

æŠ½è±¡åŸºç±»æä¾›äº†ä¸€ç§å®šä¹‰æ¥å£çš„æ–¹å¼ï¼Œç¡®ä¿å­ç±»å¿…é¡»å®ç°ç‰¹å®šçš„æ–¹æ³•ï¼š

```python
from abc import ABC, abstractmethod

class Shape(ABC):
    """æŠ½è±¡å½¢çŠ¶ç±»"""
    
    def __init__(self, color):
        self.color = color
    
    @abstractmethod
    def area(self):
        """æŠ½è±¡æ–¹æ³•ï¼šè®¡ç®—é¢ç§¯"""
        pass
    
    @abstractmethod
    def perimeter(self):
        """æŠ½è±¡æ–¹æ³•ï¼šè®¡ç®—å‘¨é•¿"""
        pass
    
    def display(self):
        """å…·ä½“æ–¹æ³•ï¼šæ˜¾ç¤ºä¿¡æ¯"""
        print(f"è¿™æ˜¯ä¸€ä¸ª{self.color}çš„{self.__class__.__name__}")
        print(f"é¢ç§¯ï¼š{self.area():.2f}")
        print(f"å‘¨é•¿ï¼š{self.perimeter():.2f}")

class Circle(Shape):
    """åœ†å½¢ç±»"""
    
    def __init__(self, color, radius):
        super().__init__(color)
        self.radius = radius
    
    def area(self):
        """å®ç°æŠ½è±¡æ–¹æ³•"""
        import math
        return math.pi * self.radius ** 2
    
    def perimeter(self):
        """å®ç°æŠ½è±¡æ–¹æ³•"""
        import math
        return 2 * math.pi * self.radius

class Rectangle(Shape):
    """çŸ©å½¢ç±»"""
    
    def __init__(self, color, width, height):
        super().__init__(color)
        self.width = width
        self.height = height
    
    def area(self):
        """å®ç°æŠ½è±¡æ–¹æ³•"""
        return self.width * self.height
    
    def perimeter(self):
        """å®ç°æŠ½è±¡æ–¹æ³•"""
        return 2 * (self.width + self.height)

class Triangle(Shape):
    """ä¸‰è§’å½¢ç±»"""
    
    def __init__(self, color, a, b, c):
        super().__init__(color)
        self.a = a  # è¾¹é•¿a
        self.b = b  # è¾¹é•¿b  
        self.c = c  # è¾¹é•¿c
    
    def area(self):
        """å®ç°æŠ½è±¡æ–¹æ³•ï¼šä½¿ç”¨æµ·ä¼¦å…¬å¼"""
        s = (self.a + self.b + self.c) / 2  # åŠå‘¨é•¿
        import math
        return math.sqrt(s * (s - self.a) * (s - self.b) * (s - self.c))
    
    def perimeter(self):
        """å®ç°æŠ½è±¡æ–¹æ³•"""
        return self.a + self.b + self.c

# æŠ½è±¡åŸºç±»çš„åº”ç”¨
def calculate_total_area(shapes):
    """è®¡ç®—å¤šä¸ªå½¢çŠ¶çš„æ€»é¢ç§¯ - å±•ç¤ºå¤šæ€"""
    total = 0
    print("ğŸ“ å½¢çŠ¶ä¿¡æ¯ç»Ÿè®¡ï¼š")
    for i, shape in enumerate(shapes, 1):
        print(f"\n{i}. {shape.__class__.__name__}ï¼š")
        shape.display()
        total += shape.area()
    
    print(f"\nğŸ“Š æ€»é¢ç§¯ï¼š{total:.2f}")
    return total

# åˆ›å»ºä¸åŒå½¢çŠ¶
shapes = [
    Circle("çº¢è‰²", 5),
    Rectangle("è“è‰²", 4, 6),
    Triangle("ç»¿è‰²", 3, 4, 5)
]

# å¤šæ€åº”ç”¨
calculate_total_area(shapes)

# å°è¯•åˆ›å»ºæŠ½è±¡ç±»å®ä¾‹ä¼šæŠ¥é”™
# shape = Shape("é¢œè‰²")  # TypeError: Can't instantiate abstract class
```

### 5.3.4 é¸­å­ç±»å‹ï¼ˆDuck Typingï¼‰

Pythonçš„"é¸­å­ç±»å‹"ï¼šå¦‚æœå®ƒèµ°è·¯åƒé¸­å­ï¼Œå«å£°åƒé¸­å­ï¼Œé‚£å®ƒå°±æ˜¯é¸­å­ã€‚

```python
# é¸­å­ç±»å‹ç¤ºä¾‹ï¼šæ–‡ä»¶å¤„ç†ç³»ç»Ÿ
class FileReader:
    """æ–‡ä»¶è¯»å–å™¨æ¥å£"""
    
    def read(self):
        """è¯»å–æ–‡ä»¶å†…å®¹"""
        pass
    
    def close(self):
        """å…³é—­æ–‡ä»¶"""
        pass

class TextFileReader:
    """æ–‡æœ¬æ–‡ä»¶è¯»å–å™¨"""
    
    def __init__(self, filename):
        self.filename = filename
        self.content = f"è¿™æ˜¯æ–‡æœ¬æ–‡ä»¶ {filename} çš„å†…å®¹"
    
    def read(self):
        print(f"ğŸ“„ è¯»å–æ–‡æœ¬æ–‡ä»¶ï¼š{self.filename}")
        return self.content
    
    def close(self):
        print(f"å…³é—­æ–‡æœ¬æ–‡ä»¶ï¼š{self.filename}")

class ImageFileReader:
    """å›¾ç‰‡æ–‡ä»¶è¯»å–å™¨"""
    
    def __init__(self, filename):
        self.filename = filename
        self.image_data = f"{filename} çš„å›¾ç‰‡æ•°æ®"
    
    def read(self):
        print(f"ğŸ–¼ï¸ è¯»å–å›¾ç‰‡æ–‡ä»¶ï¼š{self.filename}")
        return self.image_data
    
    def close(self):
        print(f"å…³é—­å›¾ç‰‡æ–‡ä»¶ï¼š{self.filename}")

class DatabaseConnection:
    """æ•°æ®åº“è¿æ¥ï¼ˆä¹Ÿæ”¯æŒ"æ–‡ä»¶"æ“ä½œï¼‰"""
    
    def __init__(self, db_name):
        self.db_name = db_name
        self.data = f"æ•°æ®åº“ {db_name} ä¸­çš„æ•°æ®"
    
    def read(self):
        print(f"ğŸ’¾ ä»æ•°æ®åº“è¯»å–ï¼š{self.db_name}")
        return self.data
    
    def close(self):
        print(f"å…³é—­æ•°æ®åº“è¿æ¥ï¼š{self.db_name}")

class WebAPI:
    """Web APIï¼ˆä¹Ÿæ”¯æŒ"æ–‡ä»¶"æ“ä½œï¼‰"""
    
    def __init__(self, url):
        self.url = url
        self.api_data = f"ä» {url} è·å–çš„APIæ•°æ®"
    
    def read(self):
        print(f"ğŸŒ è°ƒç”¨APIï¼š{self.url}")
        return self.api_data
    
    def close(self):
        print(f"å…³é—­APIè¿æ¥ï¼š{self.url}")

# é¸­å­ç±»å‹çš„æ–‡ä»¶å¤„ç†å‡½æ•°
def process_file(file_obj):
    """
    å¤„ç†"æ–‡ä»¶"å¯¹è±¡ - ä½¿ç”¨é¸­å­ç±»å‹
    åªè¦å¯¹è±¡æœ‰read()å’Œclose()æ–¹æ³•ï¼Œå°±å¯ä»¥è¢«å¤„ç†
    """
    try:
        print(f"å¼€å§‹å¤„ç†ï¼š{file_obj.__class__.__name__}")
        data = file_obj.read()  # è°ƒç”¨readæ–¹æ³•
        print(f"å¤„ç†æ•°æ®ï¼š{data[:50]}...")
        return data
    finally:
        file_obj.close()  # è°ƒç”¨closeæ–¹æ³•

# åˆ›å»ºä¸åŒç±»å‹çš„"æ–‡ä»¶"å¯¹è±¡
file_objects = [
    TextFileReader("document.txt"),
    ImageFileReader("photo.jpg"),
    DatabaseConnection("user_data"),
    WebAPI("https://api.example.com/users")
]

# é¸­å­ç±»å‹ï¼šåªè¦æœ‰ç›¸åŒçš„æ–¹æ³•ï¼Œå°±èƒ½è¢«ç›¸åŒçš„å‡½æ•°å¤„ç†
print("ğŸ¦† é¸­å­ç±»å‹æ¼”ç¤ºï¼š")
for file_obj in file_objects:
    print("\n" + "="*50)
    result = process_file(file_obj)
    print("å¤„ç†å®Œæˆ")
```

### 5.3.5 åè®®ï¼ˆProtocolï¼‰- Python 3.8+

Python 3.8å¼•å…¥äº†Protocolï¼Œæä¾›äº†æ›´æ­£å¼çš„é¸­å­ç±»å‹å®šä¹‰ï¼š

```python
from typing import Protocol

class Drawable(Protocol):
    """å¯ç»˜åˆ¶å¯¹è±¡åè®®"""
    
    def draw(self) -> None:
        """ç»˜åˆ¶å¯¹è±¡"""
        ...
    
    def get_area(self) -> float:
        """è·å–é¢ç§¯"""
        ...

class Circle:
    """åœ†å½¢ - å®ç°Drawableåè®®"""
    
    def __init__(self, radius):
        self.radius = radius
    
    def draw(self):
        print(f"ç»˜åˆ¶åŠå¾„ä¸º{self.radius}çš„åœ†å½¢")
    
    def get_area(self):
        import math
        return math.pi * self.radius ** 2

class Square:
    """æ­£æ–¹å½¢ - å®ç°Drawableåè®®"""
    
    def __init__(self, side):
        self.side = side
    
    def draw(self):
        print(f"ç»˜åˆ¶è¾¹é•¿ä¸º{self.side}çš„æ­£æ–¹å½¢")
    
    def get_area(self):
        return self.side ** 2

# ä½¿ç”¨åè®®çš„å‡½æ•°
def render_shape(shape: Drawable):
    """æ¸²æŸ“å½¢çŠ¶ - ä½¿ç”¨åè®®ç±»å‹æç¤º"""
    shape.draw()
    print(f"é¢ç§¯ï¼š{shape.get_area():.2f}")

# åè®®ä¸éœ€è¦æ˜¾å¼ç»§æ‰¿
circle = Circle(5)
square = Square(4)

render_shape(circle)  # OK
render_shape(square)  # OK
```

## ğŸ”„ 5.4 é«˜çº§ç»§æ‰¿ç‰¹æ€§

### 5.4.1 å¤šé‡ç»§æ‰¿

Pythonæ”¯æŒå¤šé‡ç»§æ‰¿ï¼Œå³ä¸€ä¸ªç±»å¯ä»¥ç»§æ‰¿å¤šä¸ªçˆ¶ç±»ï¼š

```python
class Flyable:
    """é£è¡Œèƒ½åŠ›"""
    
    def __init__(self):
        self.altitude = 0
        self.flying = False
    
    def take_off(self):
        self.flying = True
        self.altitude = 100
        print("èµ·é£ï¼å½“å‰é«˜åº¦ï¼š100ç±³")
    
    def land(self):
        self.flying = False
        self.altitude = 0
        print("é™è½ï¼")
    
    def fly_to_altitude(self, target_altitude):
        if self.flying:
            self.altitude = target_altitude
            print(f"é£è¡Œåˆ°é«˜åº¦ï¼š{target_altitude}ç±³")

class Swimmable:
    """æ¸¸æ³³èƒ½åŠ›"""
    
    def __init__(self):
        self.depth = 0
        self.swimming = False
    
    def dive(self):
        self.swimming = True
        self.depth = 5
        print("ä¸‹æ½œï¼å½“å‰æ·±åº¦ï¼š5ç±³")
    
    def surface(self):
        self.swimming = False
        self.depth = 0
        print("æµ®å‡ºæ°´é¢ï¼")
    
    def swim_to_depth(self, target_depth):
        if self.swimming:
            self.depth = target_depth
            print(f"æ¸¸æ³³åˆ°æ·±åº¦ï¼š{target_depth}ç±³")

class Animal:
    """åŠ¨ç‰©åŸºç±»"""
    
    def __init__(self, name):
        self.name = name
        self.energy = 100
    
    def eat(self):
        self.energy = min(100, self.energy + 20)
        print(f"{self.name}è¿›é£Ÿï¼Œèƒ½é‡ï¼š{self.energy}")
    
    def rest(self):
        self.energy = 100
        print(f"{self.name}ä¼‘æ¯ï¼Œèƒ½é‡æ¢å¤åˆ°æ»¡å€¼")

# å¤šé‡ç»§æ‰¿ï¼šé¸­å­æ—¢èƒ½é£åˆèƒ½æ¸¸æ³³
class Duck(Animal, Flyable, Swimmable):
    """é¸­å­ - å¤šé‡ç»§æ‰¿ç¤ºä¾‹"""
    
    def __init__(self, name):
        Animal.__init__(self, name)
        Flyable.__init__(self)
        Swimmable.__init__(self)
        self.feathers = True
    
    def quack(self):
        print(f"é¸­å­{self.name}ï¼šå˜å˜å˜ï¼")
    
    def swim_and_fly_demo(self):
        """å±•ç¤ºå¤šé‡ç»§æ‰¿çš„èƒ½åŠ›"""
        print(f"\nğŸ¦† {self.name}çš„æŠ€èƒ½æ¼”ç¤ºï¼š")
        
        # æ¸¸æ³³æŠ€èƒ½
        self.dive()
        self.swim_to_depth(10)
        self.surface()
        
        # é£è¡ŒæŠ€èƒ½
        self.take_off()
        self.fly_to_altitude(200)
        self.land()
        
        # åŸºæœ¬åŠ¨ç‰©è¡Œä¸º
        self.eat()
        self.quack()

# åˆ›å»ºé¸­å­å¹¶æ¼”ç¤ºå¤šé‡ç»§æ‰¿
duck = Duck("å”è€é¸­")
duck.swim_and_fly_demo()
```

### 5.4.2 æ–¹æ³•è§£æé¡ºåºï¼ˆMROï¼‰

å½“ä½¿ç”¨å¤šé‡ç»§æ‰¿æ—¶ï¼ŒPythonä½¿ç”¨C3çº¿æ€§åŒ–ç®—æ³•ç¡®å®šæ–¹æ³•è§£æé¡ºåºï¼š

```python
class A:
    def method(self):
        print("Açš„æ–¹æ³•")

class B(A):
    def method(self):
        print("Bçš„æ–¹æ³•")
        super().method()

class C(A):
    def method(self):
        print("Cçš„æ–¹æ³•")
        super().method()

class D(B, C):
    def method(self):
        print("Dçš„æ–¹æ³•")
        super().method()

# æŸ¥çœ‹æ–¹æ³•è§£æé¡ºåº
print("MROï¼ˆæ–¹æ³•è§£æé¡ºåºï¼‰ï¼š")
for i, cls in enumerate(D.__mro__):
    print(f"{i+1}. {cls.__name__}")

print("\nè°ƒç”¨Dçš„method()ï¼š")
d = D()
d.method()

# å®é™…åº”ç”¨ï¼šMixinæ¨¡å¼
class LoggerMixin:
    """æ—¥å¿—æ··å…¥ç±»"""
    
    def log(self, message):
        class_name = self.__class__.__name__
        print(f"[{class_name}] {message}")

class ValidatorMixin:
    """éªŒè¯æ··å…¥ç±»"""
    
    def validate(self, data):
        if not data:
            raise ValueError("æ•°æ®ä¸èƒ½ä¸ºç©º")
        self.log(f"éªŒè¯é€šè¿‡ï¼š{data}")
        return True

class CacheMixin:
    """ç¼“å­˜æ··å…¥ç±»"""
    
    def __init__(self, *args, **kwargs):
        super().__init__(*args, **kwargs)
        self._cache = {}
    
    def get_from_cache(self, key):
        if key in self._cache:
            self.log(f"ç¼“å­˜å‘½ä¸­ï¼š{key}")
            return self._cache[key]
        return None
    
    def save_to_cache(self, key, value):
        self._cache[key] = value
        self.log(f"ä¿å­˜åˆ°ç¼“å­˜ï¼š{key}")

class DataProcessor(LoggerMixin, ValidatorMixin, CacheMixin):
    """æ•°æ®å¤„ç†å™¨ - ä½¿ç”¨å¤šä¸ªMixin"""
    
    def __init__(self, name):
        super().__init__()
        self.name = name
        self.log(f"åˆ›å»ºæ•°æ®å¤„ç†å™¨ï¼š{name}")
    
    def process(self, data):
        """å¤„ç†æ•°æ®"""
        # æ£€æŸ¥ç¼“å­˜
        cached = self.get_from_cache(data)
        if cached:
            return cached
        
        # éªŒè¯æ•°æ®
        self.validate(data)
        
        # å¤„ç†æ•°æ®
        result = f"å¤„ç†ç»“æœï¼š{data.upper()}"
        self.log(f"æ•°æ®å¤„ç†å®Œæˆ")
        
        # ä¿å­˜åˆ°ç¼“å­˜
        self.save_to_cache(data, result)
        
        return result

# æ¼”ç¤ºMixinæ¨¡å¼
processor = DataProcessor("æ–‡æœ¬å¤„ç†å™¨")
print("\nç¬¬ä¸€æ¬¡å¤„ç†ï¼š")
result1 = processor.process("hello world")
print(f"ç»“æœï¼š{result1}")

print("\nç¬¬äºŒæ¬¡å¤„ç†ï¼ˆç¼“å­˜å‘½ä¸­ï¼‰ï¼š")
result2 = processor.process("hello world")
print(f"ç»“æœï¼š{result2}")
```

### 5.4.3 super()åœ¨å¤šé‡ç»§æ‰¿ä¸­çš„åº”ç”¨

```python
class Base:
    def __init__(self, value):
        self.value = value
        print(f"Base.__init__: {value}")

class A(Base):
    def __init__(self, value, a_param):
        print(f"A.__init__ å¼€å§‹")
        super().__init__(value)
        self.a_param = a_param
        print(f"A.__init__ ç»“æŸ")

class B(Base):
    def __init__(self, value, b_param):
        print(f"B.__init__ å¼€å§‹")
        super().__init__(value)
        self.b_param = b_param
        print(f"B.__init__ ç»“æŸ")

class C(A, B):
    def __init__(self, value, a_param, b_param, c_param):
        print(f"C.__init__ å¼€å§‹")
        # ä½¿ç”¨å…³é”®å­—å‚æ•°ç¡®ä¿æ­£ç¡®çš„å‚æ•°ä¼ é€’
        A.__init__(self, value, a_param)
        B.__init__(self, value, b_param)
        self.c_param = c_param
        print(f"C.__init__ ç»“æŸ")

# æ›´å¥½çš„æ–¹å¼ï¼šä½¿ç”¨**kwargs
class BetterBase:
    def __init__(self, value, **kwargs):
        self.value = value
        super().__init__(**kwargs)
        print(f"BetterBase.__init__: {value}")

class BetterA(BetterBase):
    def __init__(self, a_param, **kwargs):
        self.a_param = a_param
        super().__init__(**kwargs)
        print(f"BetterA.__init__: {a_param}")

class BetterB(BetterBase):
    def __init__(self, b_param, **kwargs):
        self.b_param = b_param
        super().__init__(**kwargs)
        print(f"BetterB.__init__: {b_param}")

class BetterC(BetterA, BetterB):
    def __init__(self, c_param, **kwargs):
        self.c_param = c_param
        super().__init__(**kwargs)
        print(f"BetterC.__init__: {c_param}")

print("åˆ›å»ºCå®ä¾‹ï¼š")
c = C("test", "a_val", "b_val", "c_val")

print("\nåˆ›å»ºBetterCå®ä¾‹ï¼š")
better_c = BetterC(
    value="test",
    a_param="a_val", 
    b_param="b_val", 
    c_param="c_val"
)
``` 

## ğŸ’» 5.5 ä»£ç ç¤ºä¾‹

### ç¤ºä¾‹1ï¼šåŠ¨ç‰©å›­ç®¡ç†ç³»ç»Ÿ

```python
from abc import ABC, abstractmethod
from datetime import datetime

class Animal(ABC):
    """åŠ¨ç‰©æŠ½è±¡åŸºç±»"""
    
    def __init__(self, name, species, age):
        self.name = name
        self.species = species
        self.age = age
        self.health = 100
        self.hunger = 0
        self.last_fed = None
    
    @abstractmethod
    def make_sound(self):
        """æŠ½è±¡æ–¹æ³•ï¼šå‘å‡ºå£°éŸ³"""
        pass
    
    @abstractmethod
    def get_habitat_type(self):
        """æŠ½è±¡æ–¹æ³•ï¼šè·å–æ –æ¯åœ°ç±»å‹"""
        pass
    
    def feed(self, food_type):
        """å–‚é£Ÿ"""
        self.hunger = 0
        self.health = min(100, self.health + 10)
        self.last_fed = datetime.now()
        print(f"ç»™{self.name}å–‚é£Ÿ{food_type}")
    
    def get_info(self):
        """è·å–åŠ¨ç‰©ä¿¡æ¯"""
        return {
            'name': self.name,
            'species': self.species,
            'age': self.age,
            'health': self.health,
            'hunger': self.hunger
        }

class Mammal(Animal):
    """å“ºä¹³åŠ¨ç‰©ç±»"""
    
    def __init__(self, name, species, age, fur_color):
        super().__init__(name, species, age)
        self.fur_color = fur_color
    
    def nurse_young(self):
        """å“ºè‚²å¹¼å´½"""
        print(f"{self.name}æ­£åœ¨å“ºè‚²å¹¼å´½")

class Bird(Animal):
    """é¸Ÿç±»"""
    
    def __init__(self, name, species, age, wing_span):
        super().__init__(name, species, age)
        self.wing_span = wing_span
        self.can_fly = True
    
    def fly(self):
        """é£è¡Œ"""
        if self.can_fly:
            print(f"{self.name}æ­£åœ¨é£ç¿”")
        else:
            print(f"{self.name}æ— æ³•é£è¡Œ")

class Lion(Mammal):
    """ç‹®å­ç±»"""
    
    def __init__(self, name, age, mane_length):
        super().__init__(name, "ç‹®å­", age, "é‡‘é»„è‰²")
        self.mane_length = mane_length
    
    def make_sound(self):
        return "å¼å¼å¼ï¼"
    
    def get_habitat_type(self):
        return "è‰åŸ"
    
    def hunt(self):
        print(f"ç‹®å­{self.name}æ­£åœ¨ç‹©çŒ")

class Eagle(Bird):
    """è€é¹°ç±»"""
    
    def __init__(self, name, age, vision_range):
        super().__init__(name, "è€é¹°", age, 2.0)
        self.vision_range = vision_range
    
    def make_sound(self):
        return "å•¸å•¸å•¸ï¼"
    
    def get_habitat_type(self):
        return "å±±åœ°"
    
    def hunt_from_sky(self):
        print(f"è€é¹°{self.name}ä»ç©ºä¸­ä¿¯å†²æ•çŒ")

class Zoo:
    """åŠ¨ç‰©å›­ç®¡ç†ç³»ç»Ÿ"""
    
    def __init__(self, name):
        self.name = name
        self.animals = []
        self.visitors = 0
    
    def add_animal(self, animal):
        """æ·»åŠ åŠ¨ç‰©"""
        self.animals.append(animal)
        print(f"åŠ¨ç‰©å›­æ·»åŠ äº†æ–°åŠ¨ç‰©ï¼š{animal.name}")
    
    def feed_all_animals(self):
        """å–‚é£Ÿæ‰€æœ‰åŠ¨ç‰©"""
        print("ğŸ å¼€å§‹ç»™æ‰€æœ‰åŠ¨ç‰©å–‚é£Ÿ...")
        for animal in self.animals:
            if isinstance(animal, Lion):
                animal.feed("è‚‰ç±»")
            elif isinstance(animal, Eagle):
                animal.feed("é±¼ç±»")
            else:
                animal.feed("é€šç”¨é£Ÿç‰©")
    
    def animal_show(self):
        """åŠ¨ç‰©è¡¨æ¼” - å±•ç¤ºå¤šæ€"""
        print("ğŸª åŠ¨ç‰©è¡¨æ¼”å¼€å§‹ï¼")
        for animal in self.animals:
            print(f"\nğŸ­ {animal.name}çš„è¡¨æ¼”ï¼š")
            print(f"   å«å£°ï¼š{animal.make_sound()}")
            print(f"   æ –æ¯åœ°ï¼š{animal.get_habitat_type()}")
            
            # æ ¹æ®åŠ¨ç‰©ç±»å‹æ‰§è¡Œç‰¹æ®Šè¡Œä¸º
            if isinstance(animal, Lion):
                animal.hunt()
            elif isinstance(animal, Eagle):
                animal.hunt_from_sky()

# ä½¿ç”¨åŠ¨ç‰©å›­ç®¡ç†ç³»ç»Ÿ
zoo = Zoo("é‡ç”ŸåŠ¨ç‰©å›­")

# æ·»åŠ ä¸åŒç±»å‹çš„åŠ¨ç‰©
lion = Lion("è¾›å·´", 5, "é•¿")
eagle = Eagle("é›„é¹°", 3, 1000)

zoo.add_animal(lion)
zoo.add_animal(eagle)

# å±•ç¤ºå¤šæ€
zoo.feed_all_animals()
zoo.animal_show()
```

### ç¤ºä¾‹2ï¼šå›¾å½¢ç”¨æˆ·ç•Œé¢æ¡†æ¶

```python
from abc import ABC, abstractmethod

class Widget(ABC):
    """GUIç»„ä»¶æŠ½è±¡åŸºç±»"""
    
    def __init__(self, x, y, width, height):
        self.x = x
        self.y = y
        self.width = width
        self.height = height
        self.visible = True
        self.children = []
        self.parent = None
    
    @abstractmethod
    def render(self):
        """æŠ½è±¡æ–¹æ³•ï¼šæ¸²æŸ“ç»„ä»¶"""
        pass
    
    def add_child(self, child):
        """æ·»åŠ å­ç»„ä»¶"""
        child.parent = self
        self.children.append(child)
    
    def show(self):
        """æ˜¾ç¤ºç»„ä»¶"""
        self.visible = True
        print(f"{self.__class__.__name__} æ˜¾ç¤º")
    
    def hide(self):
        """éšè—ç»„ä»¶"""
        self.visible = False
        print(f"{self.__class__.__name__} éšè—")

class Container(Widget):
    """å®¹å™¨ç»„ä»¶"""
    
    def render(self):
        if self.visible:
            print(f"æ¸²æŸ“å®¹å™¨ ({self.x}, {self.y}, {self.width}x{self.height})")
            for child in self.children:
                child.render()

class Button(Widget):
    """æŒ‰é’®ç»„ä»¶"""
    
    def __init__(self, x, y, width, height, text, onclick=None):
        super().__init__(x, y, width, height)
        self.text = text
        self.onclick = onclick
    
    def render(self):
        if self.visible:
            print(f"æ¸²æŸ“æŒ‰é’® '{self.text}' ({self.x}, {self.y})")
    
    def click(self):
        """ç‚¹å‡»äº‹ä»¶"""
        print(f"æŒ‰é’® '{self.text}' è¢«ç‚¹å‡»")
        if self.onclick:
            self.onclick()

class TextInput(Widget):
    """æ–‡æœ¬è¾“å…¥æ¡†"""
    
    def __init__(self, x, y, width, height, placeholder=""):
        super().__init__(x, y, width, height)
        self.text = ""
        self.placeholder = placeholder
    
    def render(self):
        if self.visible:
            display_text = self.text or self.placeholder
            print(f"æ¸²æŸ“è¾“å…¥æ¡† '{display_text}' ({self.x}, {self.y})")
    
    def set_text(self, text):
        """è®¾ç½®æ–‡æœ¬"""
        self.text = text
        print(f"è¾“å…¥æ¡†æ–‡æœ¬è®¾ç½®ä¸ºï¼š'{text}'")

class Label(Widget):
    """æ ‡ç­¾ç»„ä»¶"""
    
    def __init__(self, x, y, width, height, text):
        super().__init__(x, y, width, height)
        self.text = text
    
    def render(self):
        if self.visible:
            print(f"æ¸²æŸ“æ ‡ç­¾ '{self.text}' ({self.x}, {self.y})")

# ç™»å½•è¡¨å•ç¤ºä¾‹
class LoginForm(Container):
    """ç™»å½•è¡¨å•"""
    
    def __init__(self, x, y):
        super().__init__(x, y, 300, 200)
        self.setup_ui()
    
    def setup_ui(self):
        """è®¾ç½®ç”¨æˆ·ç•Œé¢"""
        # æ ‡é¢˜
        title = Label(10, 10, 280, 30, "ç”¨æˆ·ç™»å½•")
        self.add_child(title)
        
        # ç”¨æˆ·å
        username_label = Label(10, 50, 80, 25, "ç”¨æˆ·åï¼š")
        self.add_child(username_label)
        
        self.username_input = TextInput(100, 50, 180, 25, "è¯·è¾“å…¥ç”¨æˆ·å")
        self.add_child(self.username_input)
        
        # å¯†ç 
        password_label = Label(10, 85, 80, 25, "å¯†ç ï¼š")
        self.add_child(password_label)
        
        self.password_input = TextInput(100, 85, 180, 25, "è¯·è¾“å…¥å¯†ç ")
        self.add_child(self.password_input)
        
        # æŒ‰é’®
        login_btn = Button(80, 130, 80, 30, "ç™»å½•", self.login)
        self.add_child(login_btn)
        
        cancel_btn = Button(180, 130, 80, 30, "å–æ¶ˆ", self.cancel)
        self.add_child(cancel_btn)
    
    def login(self):
        """ç™»å½•å¤„ç†"""
        username = self.username_input.text
        password = self.password_input.text
        print(f"æ‰§è¡Œç™»å½•ï¼šç”¨æˆ·å={username}, å¯†ç ={'*' * len(password)}")
    
    def cancel(self):
        """å–æ¶ˆå¤„ç†"""
        print("å–æ¶ˆç™»å½•")
        self.hide()

# ä½¿ç”¨GUIæ¡†æ¶
login_form = LoginForm(100, 100)

print("æ¸²æŸ“ç™»å½•è¡¨å•ï¼š")
login_form.render()

print("\nç”¨æˆ·è¾“å…¥ï¼š")
login_form.username_input.set_text("admin")
login_form.password_input.set_text("123456")

print("\nç‚¹å‡»ç™»å½•æŒ‰é’®ï¼š")
login_form.children[4].click()  # ç™»å½•æŒ‰é’®
```

## ğŸ‹ï¸â€â™€ï¸ 5.6 ç»ƒä¹ é¢˜

### åŸºç¡€ç»ƒä¹ 

#### ç»ƒä¹ 1ï¼šè½¦è¾†ç»§æ‰¿ä½“ç³»
è®¾è®¡ä¸€ä¸ªè½¦è¾†ç»§æ‰¿ä½“ç³»ï¼ŒåŒ…å«ä»¥ä¸‹è¦æ±‚ï¼š
- åŸºç±» `Vehicle`ï¼šåŒ…å«å“ç‰Œã€å‹å·ã€é€Ÿåº¦ç­‰å±æ€§
- å­ç±» `Car`ï¼šæ·»åŠ é—¨çš„æ•°é‡ã€æ˜¯å¦ä¸ºSUVç­‰å±æ€§
- å­ç±» `Motorcycle`ï¼šæ·»åŠ å¼•æ“æ’é‡ã€æ˜¯å¦ä¸ºè·‘è½¦ç­‰å±æ€§
- å®ç°å¤šæ€ï¼šä¸åŒè½¦è¾†æœ‰ä¸åŒçš„å¯åŠ¨æ–¹å¼

**æç¤ºä»£ç æ¡†æ¶**ï¼š
```python
class Vehicle:
    def __init__(self, brand, model):
        # å®ç°åŸºç±»åˆå§‹åŒ–
        pass
    
    def start(self):
        # åŸºç±»å¯åŠ¨æ–¹æ³•
        pass
    
    def stop(self):
        # åŸºç±»åœæ­¢æ–¹æ³•
        pass

class Car(Vehicle):
    def __init__(self, brand, model, doors):
        # å®ç°å­ç±»åˆå§‹åŒ–
        pass
    
    def start(self):
        # é‡å†™å¯åŠ¨æ–¹æ³•
        pass

# åˆ›å»ºä¸åŒè½¦è¾†å¹¶æµ‹è¯•å¤šæ€
vehicles = [Car("ä¸°ç”°", "å¡ç½—æ‹‰", 4), Motorcycle("é›…é©¬å“ˆ", "R1", 1000)]
for vehicle in vehicles:
    vehicle.start()
```

#### ç»ƒä¹ 2ï¼šå‘˜å·¥ç®¡ç†ç³»ç»Ÿ
åˆ›å»ºä¸€ä¸ªå‘˜å·¥ç®¡ç†ç³»ç»Ÿï¼Œè¦æ±‚ï¼š
- åŸºç±» `Employee`ï¼šå§“åã€å·¥å·ã€åŸºæœ¬å·¥èµ„
- å­ç±» `Manager`ï¼šç®¡ç†å›¢é˜Ÿå¤§å°ã€å¥–é‡‘è®¡ç®—
- å­ç±» `Developer`ï¼šç¼–ç¨‹è¯­è¨€åˆ—è¡¨ã€é¡¹ç›®å¥–é‡‘
- å­ç±» `Sales`ï¼šé”€å”®é¢ã€ææˆæ¯”ä¾‹
- å®ç°å·¥èµ„è®¡ç®—çš„å¤šæ€

### ä¸­çº§ç»ƒä¹ 

#### ç»ƒä¹ 3ï¼šæ–‡ä»¶å¤„ç†ç³»ç»Ÿ
ä½¿ç”¨æŠ½è±¡åŸºç±»è®¾è®¡æ–‡ä»¶å¤„ç†ç³»ç»Ÿï¼š
- æŠ½è±¡åŸºç±» `FileProcessor`ï¼šå®šä¹‰å¤„ç†æ–‡ä»¶çš„æ¥å£
- å…·ä½“ç±» `TextProcessor`ï¼šå¤„ç†æ–‡æœ¬æ–‡ä»¶
- å…·ä½“ç±» `ImageProcessor`ï¼šå¤„ç†å›¾ç‰‡æ–‡ä»¶
- å…·ä½“ç±» `VideoProcessor`ï¼šå¤„ç†è§†é¢‘æ–‡ä»¶
- æ¯ç§å¤„ç†å™¨æœ‰ä¸åŒçš„å¤„ç†æ–¹æ³•

**è¦æ±‚**ï¼š
- ä½¿ç”¨ABCæ¨¡å—åˆ›å»ºæŠ½è±¡åŸºç±»
- å®ç°å¤šæ€çš„æ–‡ä»¶æ‰¹å¤„ç†åŠŸèƒ½
- æ·»åŠ æ–‡ä»¶å¤§å°ã€å¤„ç†æ—¶é—´ç­‰ç»Ÿè®¡ä¿¡æ¯

### é«˜çº§ç»ƒä¹ 

#### ç»ƒä¹ 4ï¼šæ¸¸æˆè§’è‰²ç³»ç»Ÿ
è®¾è®¡ä¸€ä¸ªæ¸¸æˆè§’è‰²ç³»ç»Ÿï¼ŒåŒ…å«ï¼š
- åŸºç±» `Character`ï¼šç”Ÿå‘½å€¼ã€æ”»å‡»åŠ›ã€é˜²å¾¡åŠ›
- æ··å…¥ç±» `Magician`ï¼šé­”æ³•æ”»å‡»èƒ½åŠ›
- æ··å…¥ç±» `Warrior`ï¼šç‰©ç†æ”»å‡»èƒ½åŠ›
- æ··å…¥ç±» `Healer`ï¼šæ²»ç–—èƒ½åŠ›
- ç»„åˆç±» `Paladin`ï¼šæˆ˜å£«+æ²»ç–—å¸ˆ
- ç»„åˆç±» `BattleMage`ï¼šæˆ˜å£«+é­”æ³•å¸ˆ

**è¦æ±‚**ï¼š
- ä½¿ç”¨å¤šé‡ç»§æ‰¿å’ŒMixinæ¨¡å¼
- å®ç°æŠ€èƒ½ç»„åˆå’Œæˆ˜æ–—ç³»ç»Ÿ
- å¤„ç†æ–¹æ³•è§£æé¡ºåºï¼ˆMROï¼‰

## ğŸ¯ 5.7 ç»¼åˆé¡¹ç›®æ¡ˆä¾‹ï¼šå›¾ä¹¦é¦†ç®¡ç†ç³»ç»Ÿ

è®©æˆ‘ä»¬è®¾è®¡ä¸€ä¸ªå®Œæ•´çš„å›¾ä¹¦é¦†ç®¡ç†ç³»ç»Ÿï¼Œç»¼åˆè¿ç”¨ç»§æ‰¿å’Œå¤šæ€çš„æ‰€æœ‰æ¦‚å¿µï¼š

```python
from abc import ABC, abstractmethod
from datetime import datetime, timedelta
from typing import List, Optional

# æŠ½è±¡åŸºç±»ï¼šå›¾ä¹¦é¦†ç‰©å“
class LibraryItem(ABC):
    """å›¾ä¹¦é¦†ç‰©å“æŠ½è±¡åŸºç±»"""
    
    def __init__(self, item_id: str, title: str, author: str, year: int):
        self.item_id = item_id
        self.title = title
        self.author = author
        self.year = year
        self.is_borrowed = False
        self.borrower = None
        self.borrow_date = None
        self.due_date = None
    
    @abstractmethod
    def get_loan_period(self) -> int:
        """è·å–å€Ÿé˜…æœŸé™ï¼ˆå¤©æ•°ï¼‰"""
        pass
    
    @abstractmethod
    def get_late_fee_per_day(self) -> float:
        """è·å–æ¯æ—¥æ»çº³é‡‘"""
        pass
    
    @abstractmethod
    def get_item_type(self) -> str:
        """è·å–ç‰©å“ç±»å‹"""
        pass
    
    def borrow(self, borrower_name: str) -> bool:
        """å€Ÿé˜…ç‰©å“"""
        if self.is_borrowed:
            return False
        
        self.is_borrowed = True
        self.borrower = borrower_name
        self.borrow_date = datetime.now()
        self.due_date = self.borrow_date + timedelta(days=self.get_loan_period())
        return True
    
    def return_item(self) -> float:
        """å½’è¿˜ç‰©å“ï¼Œè¿”å›æ»çº³é‡‘"""
        if not self.is_borrowed:
            return 0.0
        
        late_fee = 0.0
        if datetime.now() > self.due_date:
            days_late = (datetime.now() - self.due_date).days
            late_fee = days_late * self.get_late_fee_per_day()
        
        self.is_borrowed = False
        self.borrower = None
        self.borrow_date = None
        self.due_date = None
        
        return late_fee
    
    def get_info(self) -> dict:
        """è·å–ç‰©å“ä¿¡æ¯"""
        return {
            'id': self.item_id,
            'title': self.title,
            'author': self.author,
            'year': self.year,
            'type': self.get_item_type(),
            'is_borrowed': self.is_borrowed,
            'borrower': self.borrower,
            'due_date': self.due_date.strftime('%Y-%m-%d') if self.due_date else None
        }

# å…·ä½“ç‰©å“ç±»
class Book(LibraryItem):
    """å›¾ä¹¦ç±»"""
    
    def __init__(self, item_id: str, title: str, author: str, year: int, 
                 pages: int, isbn: str):
        super().__init__(item_id, title, author, year)
        self.pages = pages
        self.isbn = isbn
    
    def get_loan_period(self) -> int:
        return 14  # 14å¤©å€Ÿé˜…æœŸ
    
    def get_late_fee_per_day(self) -> float:
        return 0.5  # æ¯æ—¥0.5å…ƒæ»çº³é‡‘
    
    def get_item_type(self) -> str:
        return "å›¾ä¹¦"

class Magazine(LibraryItem):
    """æ‚å¿—ç±»"""
    
    def __init__(self, item_id: str, title: str, author: str, year: int, 
                 issue_number: int):
        super().__init__(item_id, title, author, year)
        self.issue_number = issue_number
    
    def get_loan_period(self) -> int:
        return 7  # 7å¤©å€Ÿé˜…æœŸ
    
    def get_late_fee_per_day(self) -> float:
        return 0.2  # æ¯æ—¥0.2å…ƒæ»çº³é‡‘
    
    def get_item_type(self) -> str:
        return "æ‚å¿—"

class DVD(LibraryItem):
    """DVDç±»"""
    
    def __init__(self, item_id: str, title: str, director: str, year: int, 
                 duration: int):
        super().__init__(item_id, title, director, year)
        self.duration = duration  # æ—¶é•¿ï¼ˆåˆ†é’Ÿï¼‰
    
    def get_loan_period(self) -> int:
        return 3  # 3å¤©å€Ÿé˜…æœŸ
    
    def get_late_fee_per_day(self) -> float:
        return 1.0  # æ¯æ—¥1å…ƒæ»çº³é‡‘
    
    def get_item_type(self) -> str:
        return "DVD"

# ç”¨æˆ·ç±»å±‚æ¬¡
class User(ABC):
    """ç”¨æˆ·æŠ½è±¡åŸºç±»"""
    
    def __init__(self, user_id: str, name: str, email: str):
        self.user_id = user_id
        self.name = name
        self.email = email
        self.borrowed_items: List[LibraryItem] = []
        self.total_late_fees = 0.0
    
    @abstractmethod
    def get_max_items(self) -> int:
        """è·å–æœ€å¤§å€Ÿé˜…æ•°é‡"""
        pass
    
    @abstractmethod
    def get_user_type(self) -> str:
        """è·å–ç”¨æˆ·ç±»å‹"""
        pass
    
    def can_borrow(self) -> bool:
        """æ£€æŸ¥æ˜¯å¦å¯ä»¥å€Ÿé˜…"""
        return len(self.borrowed_items) < self.get_max_items()
    
    def borrow_item(self, item: LibraryItem) -> bool:
        """å€Ÿé˜…ç‰©å“"""
        if not self.can_borrow():
            return False
        
        if item.borrow(self.name):
            self.borrowed_items.append(item)
            return True
        return False
    
    def return_item(self, item: LibraryItem) -> float:
        """å½’è¿˜ç‰©å“"""
        if item in self.borrowed_items:
            late_fee = item.return_item()
            self.borrowed_items.remove(item)
            self.total_late_fees += late_fee
            return late_fee
        return 0.0

class Student(User):
    """å­¦ç”Ÿç”¨æˆ·"""
    
    def __init__(self, user_id: str, name: str, email: str, student_id: str):
        super().__init__(user_id, name, email)
        self.student_id = student_id
    
    def get_max_items(self) -> int:
        return 5  # å­¦ç”Ÿæœ€å¤šå€Ÿ5æœ¬
    
    def get_user_type(self) -> str:
        return "å­¦ç”Ÿ"

class Faculty(User):
    """æ•™èŒå·¥ç”¨æˆ·"""
    
    def __init__(self, user_id: str, name: str, email: str, department: str):
        super().__init__(user_id, name, email)
        self.department = department
    
    def get_max_items(self) -> int:
        return 10  # æ•™èŒå·¥æœ€å¤šå€Ÿ10æœ¬
    
    def get_user_type(self) -> str:
        return "æ•™èŒå·¥"

class PublicUser(User):
    """å…¬ä¼—ç”¨æˆ·"""
    
    def get_max_items(self) -> int:
        return 3  # å…¬ä¼—ç”¨æˆ·æœ€å¤šå€Ÿ3æœ¬
    
    def get_user_type(self) -> str:
        return "å…¬ä¼—ç”¨æˆ·"

# å›¾ä¹¦é¦†ç®¡ç†ç³»ç»Ÿ
class Library:
    """å›¾ä¹¦é¦†ç®¡ç†ç³»ç»Ÿ"""
    
    def __init__(self, name: str):
        self.name = name
        self.items: List[LibraryItem] = []
        self.users: List[User] = []
    
    def add_item(self, item: LibraryItem):
        """æ·»åŠ ç‰©å“"""
        self.items.append(item)
        print(f"æ·»åŠ {item.get_item_type()}ï¼š{item.title}")
    
    def add_user(self, user: User):
        """æ·»åŠ ç”¨æˆ·"""
        self.users.append(user)
        print(f"æ³¨å†Œ{user.get_user_type()}ï¼š{user.name}")
    
    def find_item(self, item_id: str) -> Optional[LibraryItem]:
        """æŸ¥æ‰¾ç‰©å“"""
        for item in self.items:
            if item.item_id == item_id:
                return item
        return None
    
    def find_user(self, user_id: str) -> Optional[User]:
        """æŸ¥æ‰¾ç”¨æˆ·"""
        for user in self.users:
            if user.user_id == user_id:
                return user
        return None
    
    def borrow_item(self, user_id: str, item_id: str) -> bool:
        """å€Ÿé˜…ç‰©å“"""
        user = self.find_user(user_id)
        item = self.find_item(item_id)
        
        if not user or not item:
            print("ç”¨æˆ·æˆ–ç‰©å“ä¸å­˜åœ¨")
            return False
        
        if user.borrow_item(item):
            print(f"{user.name}æˆåŠŸå€Ÿé˜…ã€Š{item.title}ã€‹")
            return True
        else:
            print(f"å€Ÿé˜…å¤±è´¥ï¼šè¶…å‡ºå€Ÿé˜…é™åˆ¶æˆ–ç‰©å“å·²è¢«å€Ÿå‡º")
            return False
    
    def return_item(self, user_id: str, item_id: str):
        """å½’è¿˜ç‰©å“"""
        user = self.find_user(user_id)
        item = self.find_item(item_id)
        
        if not user or not item:
            print("ç”¨æˆ·æˆ–ç‰©å“ä¸å­˜åœ¨")
            return
        
        late_fee = user.return_item(item)
        if late_fee > 0:
            print(f"{user.name}å½’è¿˜ã€Š{item.title}ã€‹ï¼Œæ»çº³é‡‘ï¼š{late_fee:.2f}å…ƒ")
        else:
            print(f"{user.name}å½’è¿˜ã€Š{item.title}ã€‹")
    
    def get_overdue_items(self) -> List[LibraryItem]:
        """è·å–é€¾æœŸç‰©å“"""
        overdue = []
        current_time = datetime.now()
        
        for item in self.items:
            if item.is_borrowed and item.due_date and current_time > item.due_date:
                overdue.append(item)
        
        return overdue
    
    def generate_report(self):
        """ç”ŸæˆæŠ¥å‘Š"""
        total_items = len(self.items)
        borrowed_items = len([item for item in self.items if item.is_borrowed])
        available_items = total_items - borrowed_items
        overdue_items = len(self.get_overdue_items())
        
        print(f"\nğŸ“Š {self.name} ç»Ÿè®¡æŠ¥å‘Š")
        print(f"æ€»è—ä¹¦ï¼š{total_items}")
        print(f"å·²å€Ÿå‡ºï¼š{borrowed_items}")
        print(f"å¯å€Ÿé˜…ï¼š{available_items}")
        print(f"é€¾æœŸæœªè¿˜ï¼š{overdue_items}")
        
        # æŒ‰ç±»å‹ç»Ÿè®¡
        type_stats = {}
        for item in self.items:
            item_type = item.get_item_type()
            type_stats[item_type] = type_stats.get(item_type, 0) + 1
        
        print("\nğŸ“š è—ä¹¦åˆ†ç±»ç»Ÿè®¡ï¼š")
        for item_type, count in type_stats.items():
            print(f"{item_type}ï¼š{count}æœ¬")

# æ¼”ç¤ºå›¾ä¹¦é¦†ç®¡ç†ç³»ç»Ÿ
def demo_library_system():
    """æ¼”ç¤ºå›¾ä¹¦é¦†ç®¡ç†ç³»ç»Ÿ"""
    
    # åˆ›å»ºå›¾ä¹¦é¦†
    library = Library("ä¸­å¤®å›¾ä¹¦é¦†")
    
    # æ·»åŠ ç‰©å“
    library.add_item(Book("B001", "Pythonç¼–ç¨‹", "å¼ ä¸‰", 2023, 300, "978-1234567890"))
    library.add_item(Book("B002", "æ•°æ®ç»“æ„", "æå››", 2022, 400, "978-0987654321"))
    library.add_item(Magazine("M001", "ç¨‹åºå‘˜æ‚å¿—", "ç¼–è¾‘éƒ¨", 2024, 202401))
    library.add_item(DVD("D001", "Pythonæ•™å­¦è§†é¢‘", "ç‹äº”", 2023, 120))
    
    # æ·»åŠ ç”¨æˆ·
    library.add_user(Student("S001", "å°æ˜", "xiaoming@email.com", "2021001"))
    library.add_user(Faculty("F001", "å¼ æ•™æˆ", "zhang@email.com", "è®¡ç®—æœºç³»"))
    library.add_user(PublicUser("P001", "å¸‚æ°‘ç‹", "wang@email.com"))
    
    print("\n" + "="*50)
    
    # å€Ÿé˜…æ“ä½œ
    print("ğŸ“– å€Ÿé˜…æ“ä½œï¼š")
    library.borrow_item("S001", "B001")  # å­¦ç”Ÿå€Ÿä¹¦
    library.borrow_item("F001", "B002")  # æ•™æˆå€Ÿä¹¦
    library.borrow_item("P001", "M001")  # å¸‚æ°‘å€Ÿæ‚å¿—
    
    print("\n" + "="*50)
    
    # å½’è¿˜æ“ä½œ
    print("ğŸ“š å½’è¿˜æ“ä½œï¼š")
    library.return_item("S001", "B001")
    library.return_item("P001", "M001")
    
    print("\n" + "="*50)
    
    # ç”ŸæˆæŠ¥å‘Š
    library.generate_report()

# è¿è¡Œæ¼”ç¤º
if __name__ == "__main__":
    demo_library_system()
```

## ğŸ¤” 5.8 æ€è€ƒé¢˜

### åŸºç¡€æ€è€ƒé¢˜
1. **ç»§æ‰¿ vs ç»„åˆ**ï¼šä»€ä¹ˆæ—¶å€™åº”è¯¥ä½¿ç”¨ç»§æ‰¿ï¼Ÿä»€ä¹ˆæ—¶å€™åº”è¯¥ä½¿ç”¨ç»„åˆï¼Ÿè¯·ç»™å‡ºå…·ä½“ä¾‹å­ã€‚

2. **æ–¹æ³•é‡å†™çš„æ„ä¹‰**ï¼šä¸ºä»€ä¹ˆéœ€è¦æ–¹æ³•é‡å†™ï¼Ÿå¦‚æœä¸é‡å†™ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ

3. **æŠ½è±¡åŸºç±»çš„ä½œç”¨**ï¼šä¸ºä»€ä¹ˆè¦ä½¿ç”¨æŠ½è±¡åŸºç±»ï¼Ÿç›´æ¥å®šä¹‰æ¥å£æ–¹æ³•ä¸è¡Œå—ï¼Ÿ

### ä¸­çº§æ€è€ƒé¢˜
4. **å¤šé‡ç»§æ‰¿çš„åˆ©å¼Š**ï¼šå¤šé‡ç»§æ‰¿æœ‰ä»€ä¹ˆä¼˜ç‚¹å’Œç¼ºç‚¹ï¼Ÿå¦‚ä½•é¿å…å¤šé‡ç»§æ‰¿çš„é—®é¢˜ï¼Ÿ

5. **MROçš„é‡è¦æ€§**ï¼šæ–¹æ³•è§£æé¡ºåºä¸ºä»€ä¹ˆé‡è¦ï¼Ÿå¦‚æœé¡ºåºé”™è¯¯ä¼šé€ æˆä»€ä¹ˆé—®é¢˜ï¼Ÿ

6. **é¸­å­ç±»å‹ vs ç»§æ‰¿**ï¼šé¸­å­ç±»å‹å’Œç»§æ‰¿å¤šæ€æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿå„è‡ªé€‚ç”¨äºä»€ä¹ˆåœºæ™¯ï¼Ÿ

### é«˜çº§æ€è€ƒé¢˜
7. **è®¾è®¡æ¨¡å¼ä¸ç»§æ‰¿**ï¼šç»§æ‰¿åœ¨è®¾è®¡æ¨¡å¼ä¸­å‘æŒ¥ä»€ä¹ˆä½œç”¨ï¼Ÿä¸¾ä¾‹è¯´æ˜ã€‚

8. **ç»§æ‰¿çš„æ·±åº¦é—®é¢˜**ï¼šç»§æ‰¿å±‚æ¬¡è¿‡æ·±ä¼šæœ‰ä»€ä¹ˆé—®é¢˜ï¼Ÿå¦‚ä½•æ§åˆ¶ç»§æ‰¿æ·±åº¦ï¼Ÿ

9. **åŠ¨æ€ç‰¹æ€§**ï¼šPythonçš„åŠ¨æ€ç‰¹æ€§å¦‚ä½•å½±å“ç»§æ‰¿å’Œå¤šæ€çš„å®ç°ï¼Ÿ

## ğŸ“– 5.9 æ‹“å±•é˜…è¯»

### ç»å…¸ä¹¦ç±
- ã€Šè®¾è®¡æ¨¡å¼ï¼šå¯å¤ç”¨é¢å‘å¯¹è±¡è½¯ä»¶çš„åŸºç¡€ã€‹
- ã€Šé‡æ„ï¼šæ”¹å–„æ—¢æœ‰ä»£ç çš„è®¾è®¡ã€‹
- ã€ŠEffective Pythonã€‹ç¬¬äºŒç‰ˆ

### åœ¨çº¿èµ„æº
- Pythonå®˜æ–¹æ–‡æ¡£ï¼šé¢å‘å¯¹è±¡ç¼–ç¨‹
- Real Pythonï¼šPythonç»§æ‰¿å’Œç»„åˆæŒ‡å—
- GeeksforGeeksï¼šPythoné¢å‘å¯¹è±¡ç¼–ç¨‹

### å®è·µé¡¹ç›®
- è®¾è®¡ä¸€ä¸ªå®Œæ•´çš„ç”µå•†ç³»ç»Ÿ
- å®ç°ä¸€ä¸ªç®€å•çš„GUIæ¡†æ¶
- å¼€å‘ä¸€ä¸ªæ¸¸æˆå¼•æ“çš„åŸºç¡€æ¶æ„

## âœ… 5.10 å­¦ä¹ æ£€æŸ¥æ¸…å•

### çŸ¥è¯†ç†è§£ âœ“
- [ ] ç†è§£ç»§æ‰¿çš„åŸºæœ¬æ¦‚å¿µå’Œè¯­æ³•
- [ ] æŒæ¡super()å‡½æ•°çš„ä½¿ç”¨
- [ ] ç†è§£æ–¹æ³•é‡å†™å’Œå¤šæ€æœºåˆ¶
- [ ] æŒæ¡æŠ½è±¡åŸºç±»çš„ä½¿ç”¨
- [ ] ç†è§£å¤šé‡ç»§æ‰¿å’ŒMRO
- [ ] äº†è§£é¸­å­ç±»å‹çš„æ¦‚å¿µ

### ç¼–ç¨‹æŠ€èƒ½ âœ“
- [ ] èƒ½è®¾è®¡åˆç†çš„ç»§æ‰¿ä½“ç³»
- [ ] èƒ½æ­£ç¡®ä½¿ç”¨å¤šæ€å®ç°ä»£ç å¤ç”¨
- [ ] èƒ½å¤„ç†å¤šé‡ç»§æ‰¿çš„å¤æ‚æƒ…å†µ
- [ ] èƒ½è¿ç”¨ç»§æ‰¿è§£å†³å®é™…é—®é¢˜

### è®¾è®¡æ€ç»´ âœ“
- [ ] èƒ½åˆ¤æ–­ä½•æ—¶ä½¿ç”¨ç»§æ‰¿vsç»„åˆ
- [ ] èƒ½è®¾è®¡æ¸…æ™°çš„ç±»å±‚æ¬¡ç»“æ„
- [ ] èƒ½è¿ç”¨é¢å‘å¯¹è±¡è®¾è®¡åŸåˆ™
- [ ] èƒ½ç¼–å†™å¯ç»´æŠ¤çš„é¢å‘å¯¹è±¡ä»£ç 

### å®è·µç»éªŒ âœ“
- [ ] å®Œæˆæ‰€æœ‰åŸºç¡€ç»ƒä¹ é¢˜
- [ ] å®Œæˆå›¾ä¹¦é¦†ç®¡ç†ç³»ç»Ÿé¡¹ç›®
- [ ] èƒ½è°ƒè¯•ç»§æ‰¿ç›¸å…³çš„é—®é¢˜
- [ ] èƒ½é‡æ„ç°æœ‰ä»£ç ä½¿ç”¨ç»§æ‰¿

---

**æ­å–œï¼** ğŸ‰ ä½ å·²ç»æŒæ¡äº†Pythoné¢å‘å¯¹è±¡ç¼–ç¨‹ä¸­æœ€é‡è¦çš„ç»§æ‰¿å’Œå¤šæ€æ¦‚å¿µã€‚è¿™äº›çŸ¥è¯†å°†ä¸ºä½ åç»­å­¦ä¹ è®¾è®¡æ¨¡å¼ã€æ¡†æ¶å¼€å‘ç­‰é«˜çº§ä¸»é¢˜å¥ å®šåšå®åŸºç¡€ã€‚

ä¸‹ä¸€ç« æˆ‘ä»¬å°†å­¦ä¹ **å¼‚å¸¸å¤„ç†ä¸è°ƒè¯•**ï¼Œå­¦ä¼šå¦‚ä½•è®©ç¨‹åºæ›´åŠ å¥å£®å’Œå¯é ï¼ 